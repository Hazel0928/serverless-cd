import{c as e,r as t,a,l as n,R as l,h as s}from"./index.js";import{P as r}from"./index3.js";import{T as o,C as i}from"./CopyIcon.js";import{F as m}from"./index9.js";import{N as c,D as d}from"./index11.js";import{B as p,N as u}from"./index7.js";import{S as x}from"./index12.js";import"./index6.js";import"./index5.js";import"./index8.js";const E=async()=>{const{data:t}=await e.get("/api/tokens/list");return t},y=async t=>await e.post("/api/tokens/create",t),f=async t=>await e.post("/api/tokens/delete",t);var g="";const k=m.Item,b=e=>{const t=a(f),n=a=>{d.confirm({title:"\u5220\u9664Token",content:"\u60a8\u786e\u5b9a\u5220\u9664\u5f53\u524dToken\u5417\uff1f",onOk:async()=>{const{success:n}=await t.request({id:a});n&&e()}})};return[{title:"\u7b80\u8ff0",dataIndex:"description"},{title:"\u6700\u8fd1\u767b\u5f55",dataIndex:"active_time",cell:e=>l.createElement("span",null,e?s(e).format("YYYY-MM-DD HH:mm:ss"):"\u6682\u672a\u767b\u5f55")},{title:"\u6709\u6548\u671f\u65f6\u95f4",dataIndex:"expire_time",cell:e=>l.createElement("span",null,-1===e?"\u6c38\u4e45\u65f6\u957f":Date.now()>e?l.createElement("span",{style:{color:"#f5a623"}},"\u5df2\u5931\u6548"):s(e).format("YYYY-MM-DD"))},{title:"\u64cd\u4f5c",dataIndex:"id",cell:e=>l.createElement(l.Fragment,null,l.createElement(p,{type:"primary",text:!0,onClick:()=>n(e)},"\u5220\u9664"))}]},v=[{value:864e5,label:"1 days"},{value:6048e5,label:"7 days"},{value:2592e6,label:"30 days"},{value:5184e6,label:"60 days"},{value:7776e6,label:"90 days"},{value:15552e6,label:"180 days"},{value:-1,label:"No Expiration"}],Y=undefined,C=()=>{const[e,f]=t.exports.useState(!1),[g,Y]=t.exports.useState(!1),[C,T]=t.exports.useState(null),{loading:j,data:D,request:h}=a(E),S=a(y),I=n.exports.get(D,"result",[]),w=n.exports.get(S.data,"data.cd_token","");t.exports.useEffect((()=>{h()}),[]),t.exports.useEffect((()=>{S.data&&n.exports.get(S.data,"data","")&&(N(),Y(!0),setTimeout((()=>{h()}),800))}),[S.data]);const N=()=>{T(null),f(!1)},M=(e,t)=>{const{description:a,expiration:l}=e;n.exports.isEmpty(t)&&S.request({description:a,expiration:l})};return l.createElement(r,{title:"Tokens",breadcrumbs:[{name:"\u8bbe\u7f6e"},{name:"Tokens"}]},l.createElement(c,{type:"notice"},"\u60a8\u751f\u6210\u7684\u4ee4\u724c\u53ef\u4ee5\u7528\u4e8e\u8bbf\u95eeServicelessCD API\u3002"),l.createElement(p,{type:"primary",className:"mr-10 mt-25 mb-25",onClick:()=>f(!0)},"\u521b\u5efa"),l.createElement(o,{dataSource:I,loading:j,hasBorder:!1,columns:b(h)}),l.createElement(d,{size:"small",title:"\u521b\u5efaToken",footer:!1,visible:e,onClose:N},l.createElement(c,{type:"notice",className:"dialog-message"},"\u4e2a\u4eba\u8bbf\u95ee\u4ee4\u724c\u7684\u529f\u80fd\u4e0e\u666e\u901aOAuth\u8bbf\u95ee\u4ee4\u724c\u7c7b\u4f3c\u3002\u5b83\u4eec\u53ef\u4ee5\u7528\u6765\u4ee3\u66ffHTTPS\u4e0a\u7684Git\u7684\u5bc6\u7801\uff0c\u4e5f\u53ef\u4ee5\u7528\u6765\u901a\u8fc7\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u5bf9API\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002"),l.createElement(m,{colon:!0},l.createElement(k,{name:"description",label:"\u7b80\u8ff0",required:!0},l.createElement(u,null)),l.createElement(k,{name:"expiration",label:"\u6709\u6548\u671f",required:!0},l.createElement(x,{placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",dataSource:v,onChange:e=>T(e),style:{width:150,marginRight:20}}),C&&l.createElement("span",null,-1===C?"\u6c38\u4e45\u6709\u6548\u671f":`\u6709\u6548\u671f\u81f3\uff1a${s(Date.now()+C).format("YYYY-MM-DD")}`)),l.createElement(k,{style:{textAlign:"right"}},l.createElement(m.Submit,{validate:!0,type:"primary",onClick:M,loading:S.loading,style:{marginRight:10}},"\u521b\u5efa"),l.createElement(p,{onClick:N},"\u53d6\u6d88")))),l.createElement(d,{size:"small",title:"\u751f\u6210Token",footer:[l.createElement(p,{onClick:()=>Y(!1)},"\u53d6\u6d88")],visible:g,onClose:()=>Y(!1)},l.createElement(c,{type:"notice",className:"dialog-message"},"\u8bf7\u590d\u5236\u60a8\u7684Token\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5728\u5b89\u5168\u7684\u5730\u65b9\u3002\u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u6211\u4eec\u4e0d\u80fd\u518d\u663e\u793a\u4e86"),l.createElement("div",{className:"snippet-token flex-r"},w,l.createElement(i,{content:w}))))};export{C as default};
