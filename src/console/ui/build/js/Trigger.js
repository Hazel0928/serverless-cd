import{c as e,a,g as t,l,r as s,R as n,N as i}from"./index.js";import{S as r}from"./index12.js";import{N as p,B as o}from"./index7.js";import{N as c}from"./index8.js";const m=async a=>await e.post("/api/flow/application/create",a),d=async()=>{const{data:a}=await e.get("/api/flow/application/list");return a},u=async a=>await e.get("/api/flow/application/detail",{params:a}),h=async a=>await e.delete("/api/flow/application/delete",{params:a}),y=async a=>await e.post("/api/flow/application/update",a);var f=(e=>(e.Template="template",e.Repository="repository",e))(f||{}),v=(e=>(e.PUSH="push",e.RELEASE="release",e))(v||{}),E=(e=>(e.BRANCH="branch",e.INPUT="input",e))(E||{});const x={env:{name:"serverless-cd",age:30},steps:[{run:"echo 'Hi {{ env.name }}'"},{run:"echo 'Hi {{ env.name }}'",env:{name:"Tony"}},{run:"echo 'Hi {{ task_id }}'"},{run:"echo 'Hi {{ app.user_name }}'"},{run:"echo 'Hi {{ git.event_name }}'"},{run:"echo 'suceess end'"}]},{Row:N,Col:g}=c,w="serverless-pipeline.yaml",b=e=>{const{repo:c}=e,{data:m,request:d,loading:u}=a(t),h=()=>[{id:l.exports.uniqueId(),type:v.PUSH,branch:null==c?void 0:c.default_branch,filterType:E.BRANCH,template:w}],y=l.exports.isEmpty(e.value)?h():l.exports.map(e.value,(e=>({...e,id:l.exports.uniqueId()}))),[f,x]=s.exports.useState(y);s.exports.useEffect((()=>{"update"!==e.type&&x(h()),c&&d({owner:c.owner,repo:c.name})}),[JSON.stringify(c)]),s.exports.useEffect((()=>{(e.onChange||l.exports.noop)(f)}),[JSON.stringify(f)]);const b=(e,a)=>{const t=l.exports.map(f,(t=>t.id===a.id?{...t,type:e}:t));x(t)},C=(e,a)=>{const t=l.exports.map(f,(t=>t.id===a.id?{...t,input:e}:t));x(t)},H=(e,a)=>{const t=l.exports.map(f,(t=>t.id===a.id?{...t,branch:e}:t));x(t)},S=()=>{x([...f,{id:l.exports.uniqueId(),type:v.PUSH,branch:null==c?void 0:c.default_branch,filterType:E.BRANCH,template:w}])},R=e=>{const a=l.exports.filter(f,(a=>a.id!==e.id));x(a)},T=(e,a)=>{const t=l.exports.map(f,(t=>t.id===a.id?{...t,filterType:e}:t));x(t)},P=(e,a)=>{const t=l.exports.map(f,(t=>t.id===a.id?{...t,template:e}:t));x(t)},A=e=>e.type===v.PUSH?n.createElement("div",{className:"align-center"},n.createElement(r,{style:{width:150},value:e.filterType,onChange:a=>T(a,e),dataSource:[{label:"\u9009\u62e9\u5206\u652f",value:E.BRANCH},{label:"\u624b\u52a8\u8f93\u5165",value:E.INPUT}]}),e.filterType===E.BRANCH?n.createElement(r,{className:"full-width",value:e.branch,onChange:a=>H(a,e),state:u?"loading":void 0,disabled:u,dataSource:l.exports.map(m,(e=>({label:e.name,value:e.name})))}):n.createElement(p,{placeholder:"\u8bf7\u8f93\u5165",value:e.input,onChange:a=>C(a,e),className:"full-width"})):n.createElement(p,{disabled:!0,value:e.input,onChange:a=>C(a,e),className:"full-width"});return n.createElement(n.Fragment,null,l.exports.map(f,(e=>n.createElement("div",{key:e.id},n.createElement(N,{gutter:16,className:"mb-8"},n.createElement(g,{span:"6"},n.createElement(r,{className:"full-width",value:e.type,onChange:a=>b(a,e),dataSource:[{label:"Push\u4ee3\u7801\u5230\u6307\u5b9a\u5206\u652f",value:v.PUSH},{label:"\u53d1\u5e03Release\u7248\u672c",value:v.RELEASE}]})),n.createElement(g,{span:"12",style:{position:"relative"}},A(e)),n.createElement(g,{span:"6"},n.createElement(p,{value:e.template,placeholder:"\u8bf7\u8f93\u5165",onChange:a=>P(a,e),className:"full-width"}),f.length>1&&n.createElement(o,{type:"primary",text:!0,onClick:()=>R(e),style:{position:"absolute"},className:"mt-6 ml-8"},n.createElement(i,{type:"delete"}))))))),n.createElement(o,{onClick:S},n.createElement(i,{type:"add",className:"mr-4"}),"\u65b0\u589e"))};export{f as C,E as I,x as S,b as T,v as a,u as b,m as c,h as d,d as l,y as u};
